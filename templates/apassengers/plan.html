<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Your Travel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body { 
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        * { font-family: Verdana, Geneva, Tahoma, sans-serif !important; }
        footer { 
            background: #f8f9fa;
            margin-top: auto;
        }
        
        .route-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .route-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .route-header {
            border-left: 4px solid #0d6efd;
            padding-left: 1rem;
            margin-bottom: 1rem;
        }
        
        .badge-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .route-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark" style="background: rgba(0,0,0,0.5); backdrop-filter: blur(10px);">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('passengers_home') }}">
            <i class="bi bi-bus-front"></i> Yatra Saarthi
        </a>
        <div class="ms-auto">
            <a href="{{ url_for('travel_guide') }}" class="btn btn-outline-success btn-sm me-2" data-en="Travel Guide" data-ta="‡Æ™‡ÆØ‡Æ£ ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡Æø">
                <i class="bi bi-signpost-split"></i> Travel Guide
            </a>
            <button type="button" class="btn btn-outline-light btn-sm me-2" onclick="changeLang(currentLang === 'en' ? 'ta' : 'en')">
                <i class="bi bi-translate"></i> <span id="langText">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</span>
            </button>
            <a class="btn btn-outline-light btn-sm" href="{{ url_for('login') }}">Admin Login</a>
        </div>
    </div>
</nav>

<div class="container py-4">
    <div class="card shadow-lg" style="background: rgba(255,255,255,0.98); border-radius: 15px;">
        <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0" data-en="Plan Your Journey" data-ta="‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ÆØ‡Æ£‡Æ§‡Øç‡Æ§‡Øà‡Æ§‡Øç ‡Æ§‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Æø‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç">Plan Your Journey</h2>
                <a href="{{ url_for('travel_guide') }}" class="btn btn-outline-success" data-en="Travel Guide" data-ta="‡Æ™‡ÆØ‡Æ£ ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡Æø">
                    <i class="bi bi-signpost-split"></i> Travel Guide
                </a>
            </div>
            
            <form method="GET" class="mb-4" id="routeForm">
                <div class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label"><strong data-en="From" data-ta="‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ">From</strong></label>
                        <select class="form-select" name="origin" id="originSelect" required>
                            <option value="" data-en="Select origin" data-ta="‡Æ§‡Øä‡Æü‡Æï‡Øç‡Æï ‡Æ™‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç">Select origin</option>
                            {% for p in places %}
                            <option value="{{ p }}" {{ p == q.origin and 'selected' or '' }}>{{ p }}</option>
                            {% endfor %}
                        </select>
                        <small class="text-muted" data-en="Your boarding point" data-ta="‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ÆØ‡Æ£‡ÆÆ‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æá‡Æü‡ÆÆ‡Øç">Your boarding point</small>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label"><strong data-en="To" data-ta="‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ">To</strong></label>
                        <select class="form-select" name="destination" id="destinationSelect" required>
                            <option value="" data-en="Select destination" data-ta="‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç">Select destination</option>
                            {% for p in places %}
                            <option value="{{ p }}" {{ p == q.destination and 'selected' or '' }}>{{ p }}</option>
                            {% endfor %}
                        </select>
                        <small class="text-muted" data-en="Where you want to go" data-ta="‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡ØÜ‡Æ≤‡Øç‡Æ≤ ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç ‡Æá‡Æü‡ÆÆ‡Øç">Where you want to go</small>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label"><strong data-en="Date" data-ta="‡Æ§‡Øá‡Æ§‡Æø">Date</strong></label>
                        <input type="date" class="form-control" name="date" id="travelDate" value="{{ q.date or '' }}">
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="bi bi-search"></i> <span data-en="Search" data-ta="‡Æ§‡Øá‡Æü‡ØÅ‡Æï">Search</span>
                        </button>
                    </div>
                </div>
            </form>

            {% if q.origin and q.destination %}
            <!-- Route Selection Alert -->
            <div class="alert alert-success border-start border-4 border-success">
                <h5 class="alert-heading">
                    <i class="bi bi-geo-alt-fill"></i> 
                    <span data-en="Route Selected" data-ta="‡Æµ‡Æ¥‡Æø ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ">Route Selected</span>
                </h5>
                <p class="mb-2">
                    <strong data-en="From:" data-ta="‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ:">From:</strong> <span class="badge bg-primary">{{ q.origin }}</span>
                    <strong data-en="To:" data-ta="‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ:" class="ms-3">To:</strong> <span class="badge bg-success">{{ q.destination }}</span>
                    {% if q.date %}
                    <strong data-en="Date:" data-ta="‡Æ§‡Øá‡Æ§‡Æø:" class="ms-3">Date:</strong> <span class="badge bg-info">{{ q.date }}</span>
                    {% endif %}
                </p>
                <hr>
                <p class="mb-0 small">
                    <i class="bi bi-info-circle"></i> 
                    <span data-en="Here are your travel options based on your route selection:" data-ta="‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æ¥‡Æø ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡Æø‡Æ©‡Øç ‡ÆÖ‡Æü‡Æø‡Æ™‡Øç‡Æ™‡Æü‡Øà‡ÆØ‡Æø‡Æ≤‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ÆØ‡Æ£ ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æá‡Æô‡Øç‡Æï‡Øá:">
                        Here are your travel options based on your route selection:
                    </span>
                </p>
            </div>
            
            <!-- Weather Information Cards -->
            <div class="row g-3 mb-3">
                {% if origin_weather %}
                <div class="col-md-6">
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <i class="bi bi-cloud-sun"></i> <strong data-en="Weather at Origin: {{ q.origin }}" data-ta="‡Æ§‡Øä‡Æü‡Æï‡Øç‡Æï‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æµ‡Ææ‡Æ©‡Æø‡Æ≤‡Øà: {{ q.origin }}">Weather at Origin: {{ q.origin }}</strong>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h3 class="mb-0">{{ origin_weather.temperature }}¬∞C</h3>
                                    <small class="text-muted" data-en="Feels like {{ origin_weather.feels_like }}¬∞C" data-ta="{{ origin_weather.feels_like }}¬∞C ‡Æ™‡Øã‡Æ≤ ‡Æâ‡Æ£‡Æ∞‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ">Feels like {{ origin_weather.feels_like }}¬∞C</small>
                                </div>
                                <div class="text-end">
                                    <div class="fs-5">{{ origin_weather.description }}</div>
                                    <small class="text-muted">üíß {{ origin_weather.humidity }}% | üí® {{ origin_weather.wind_speed }} km/h</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                {% if dest_weather %}
                <div class="col-md-6">
                    <div class="card border-success">
                        <div class="card-header bg-success text-white">
                            <i class="bi bi-cloud-sun-fill"></i> <strong data-en="Weather at Destination: {{ q.destination }}" data-ta="‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Æø‡Æ≤‡Øç ‡Æµ‡Ææ‡Æ©‡Æø‡Æ≤‡Øà: {{ q.destination }}">Weather at Destination: {{ q.destination }}</strong>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h3 class="mb-0">{{ dest_weather.temperature }}¬∞C</h3>
                                    <small class="text-muted" data-en="Feels like {{ dest_weather.feels_like }}¬∞C" data-ta="{{ dest_weather.feels_like }}¬∞C ‡Æ™‡Øã‡Æ≤ ‡Æâ‡Æ£‡Æ∞‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ">Feels like {{ dest_weather.feels_like }}¬∞C</small>
                                </div>
                                <div class="text-end">
                                    <div class="fs-5">{{ dest_weather.description }}</div>
                                    <small class="text-muted">üíß {{ dest_weather.humidity }}% | üí® {{ dest_weather.wind_speed }} km/h</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            
            <!-- Weather-Based Recommendations -->
            {% if origin_recommendations or dest_recommendations %}
            <div class="mb-3">
                <h6 class="mb-2"><i class="bi bi-bell-fill text-warning"></i> <span data-en="Travel Recommendations" data-ta="‡Æ™‡ÆØ‡Æ£ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç">Travel Recommendations</span></h6>
                {% for rec in origin_recommendations %}
                <div class="alert alert-{{ rec.type }} alert-dismissible fade show" role="alert">
                    <strong>{{ rec.icon }}</strong> {{ rec.message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
                {% endfor %}
                {% for rec in dest_recommendations %}
                <div class="alert alert-{{ rec.type }} alert-dismissible fade show" role="alert">
                    <strong>{{ rec.icon }}</strong> {{ rec.message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Nearby Railway Station Recommendations -->
            <div class="row g-3 mb-3">
                {% if origin_station_info %}
                <div class="col-md-6">
                    <div class="card border-info">
                        <div class="card-header bg-info text-white">
                            <i class="bi bi-train-front"></i> 
                            <strong data-en="Nearest Railway Stations from {{ q.origin }}" data-ta="{{ q.origin }} ‡Æá‡Æ≤‡Æø‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç">Nearest Railway Stations from {{ q.origin }}</strong>
                        </div>
                        <div class="card-body">
                            {% if origin_station_info.distance != 'Direct' %}
                            <div class="alert alert-warning mb-2">
                                <i class="bi bi-exclamation-triangle"></i>
                                <span data-en="No direct railway station at {{ q.origin }}" data-ta="{{ q.origin }} ‡Æá‡Æ≤‡Øç ‡Æ®‡Øá‡Æ∞‡Æü‡Æø ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà">No direct railway station at {{ q.origin }}</span>
                            </div>
                            {% endif %}
                            <h6 data-en="Recommended Station:" data-ta="‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡ÆÆ‡Øç:">Recommended Station:</h6>
                            <div class="d-flex align-items-center mb-2">
                                <span class="badge bg-primary fs-6 me-2">{{ origin_station_info.station }}</span>
                                <small class="text-muted">({{ origin_station_info.distance }})</small>
                            </div>
                            <div class="mb-2">
                                <small class="text-muted" data-en="Alternative options:" data-ta="‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡ØÅ ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øç:">Alternative options:</small>
                                <div class="mt-1">
                                    {% for alt in origin_station_info.alternatives %}
                                        <span class="badge bg-secondary me-1">{{ alt }}</span>
                                    {% endfor %}
                                </div>
                            </div>
                            <small class="text-info">
                                <i class="bi bi-info-circle"></i>
                                <span data-en="Book your train tickets from these nearby stations" data-ta="‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Æø‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ™‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç">Book your train tickets from these nearby stations</span>
                            </small>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                {% if dest_station_info %}
                <div class="col-md-6">
                    <div class="card border-info">
                        <div class="card-header bg-info text-white">
                            <i class="bi bi-train-front"></i> 
                            <strong data-en="Nearest Railway Stations to {{ q.destination }}" data-ta="{{ q.destination }} ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç">Nearest Railway Stations to {{ q.destination }}</strong>
                        </div>
                        <div class="card-body">
                            {% if dest_station_info.distance != 'Direct' %}
                            <div class="alert alert-warning mb-2">
                                <i class="bi bi-exclamation-triangle"></i>
                                <span data-en="No direct railway station at {{ q.destination }}" data-ta="{{ q.destination }} ‡Æá‡Æ≤‡Øç ‡Æ®‡Øá‡Æ∞‡Æü‡Æø ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà">No direct railway station at {{ q.destination }}</span>
                            </div>
                            {% endif %}
                            <h6 data-en="Recommended Station:" data-ta="‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡ÆÆ‡Øç:">Recommended Station:</h6>
                            <div class="d-flex align-items-center mb-2">
                                <span class="badge bg-primary fs-6 me-2">{{ dest_station_info.station }}</span>
                                <small class="text-muted">({{ dest_station_info.distance }})</small>
                            </div>
                            <div class="mb-2">
                                <small class="text-muted" data-en="Alternative options:" data-ta="‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡ØÅ ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øç:">Alternative options:</small>
                                <div class="mt-1">
                                    {% for alt in dest_station_info.alternatives %}
                                        <span class="badge bg-secondary me-1">{{ alt }}</span>
                                    {% endfor %}
                                </div>
                            </div>
                            <small class="text-info">
                                <i class="bi bi-info-circle"></i>
                                <span data-en="Get down at these nearby stations to reach {{ q.destination }}" data-ta="{{ q.destination }} ‡Æï‡Øç‡Æï‡ØÅ ‡Æö‡ØÜ‡Æ≤‡Øç‡Æ≤ ‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æá‡Æ±‡Æô‡Øç‡Æï‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç">Get down at these nearby stations to reach {{ q.destination }}</span>
                            </small>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            
            <div class="row g-3">
                <!-- Bus Options -->
                <div class="col-lg-6">
                    <div class="route-card">
                        <div class="route-header">
                            <h5 class="mb-0">
                                <i class="bi bi-bus-front text-primary"></i>
                                <span class="ms-2" data-en="Bus Services" data-ta="‡Æ™‡Øá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç">Bus Services</span>
                            </h5>
                        </div>
                        
                        {% if direct_services and direct_services|length %}
                            <div class="mb-3">
                                <span class="badge bg-success badge-pulse" data-en="{{ direct_services|length }} Direct Services Available" data-ta="{{ direct_services|length }} ‡Æ®‡Øá‡Æ∞‡Æü‡Æø ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ©‡Øç‡Æ±‡Æ©">
                                    {{ direct_services|length }} Direct Services Available
                                </span>
                                <a href="{{ url_for('passenger_timetables', origin=q.origin, destination=q.destination) }}" 
                                   class="btn btn-sm btn-outline-primary ms-2" data-en="View Timetables" data-ta="‡Æ®‡Øá‡Æ∞ ‡ÆÖ‡Æü‡Øç‡Æü‡Æµ‡Æ£‡Øà‡ÆØ‡Øà‡Æï‡Øç ‡Æï‡Ææ‡Æ£‡Øç‡Æï">
                                    <i class="bi bi-clock-history"></i> View Timetables
                                </a>
                            </div>
                            <div class="list-group list-group-flush">
                                {% for s in direct_services[:3] %}
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <div class="fw-bold">{{ s.service_number }} ¬∑ {{ s.bus_number }}</div>
                                            <small class="text-muted">{{ s.origin }} ‚Üí {{ s.destination }}</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="badge bg-primary" data-en="Dep" data-ta="‡Æ™‡ØÅ‡Æ±">Dep</div>
                                            <div class="small">{{ s.departure_time.strftime('%I:%M %p') }}</div>
                                            <div class="badge bg-success" data-en="Arr" data-ta="‡Æµ‡Æ∞‡Øà">Arr</div>
                                            <div class="small">{{ s.arrival_time.strftime('%I:%M %p') }}</div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                            <div class="mt-3">
                                <a target="_blank" href="{{ links.redbus }}" class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-box-arrow-up-right"></i> <span data-en="Check Live Buses" data-ta="‡Æ®‡Øá‡Æ∞‡Æü‡Æø ‡Æ™‡Øá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ‡Æï‡Æ≥‡Øà ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï">Check Live Buses</span>
                                </a>
                            </div>
                        {% else %}
                            <p class="text-muted" data-en="Checking for alternative routes..." data-ta="‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡ØÅ ‡Æµ‡Æ¥‡Æø‡Æï‡Æ≥‡Øà‡Æö‡Øç ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...">Checking for alternative routes...</p>
            <!-- Multi-Modal Coordination Recommendations -->
            {% if coordination_recommendations and coordination_recommendations|length %}
            <div class="row g-3 mb-4">
                <div class="col-12">
                    <div class="card border-success shadow-sm">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="bi bi-diagram-3"></i>
                                <span class="ms-2" data-en="Multi-Modal Connection Recommendations" data-ta="‡Æ™‡Æ≤ ‡ÆÆ‡ØÅ‡Æ±‡Øà ‡Æá‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç">Multi-Modal Connection Recommendations</span>
                            </h5>
                            <small data-en="Smart connections between bus, train, and flight services" data-ta="‡Æ™‡Øá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ, ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æø‡ÆÆ‡Ææ‡Æ© ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æá‡Æü‡Øà‡ÆØ‡Øá‡ÆØ‡Ææ‡Æ© ‡Æ∏‡Øç‡ÆÆ‡Ææ‡Æ∞‡Øç‡Æü‡Øç ‡Æá‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç">Smart connections between bus, train, and flight services</small>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                {% for rec in coordination_recommendations %}
                                <div class="col-md-6">
                                    <div class="card h-100 border-{{ 'primary' if rec.type == 'bus_train' else 'info' }}">
                                        <div class="card-header bg-{{ 'primary' if rec.type == 'bus_train' else 'info' }} text-white">
                                            <h6 class="mb-0">
                                                <span class="fs-4">{{ rec.icon }}</span>
                                                <span class="ms-2">{{ rec.title }}</span>
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <p class="text-muted mb-3">{{ rec.description }}</p>
                                            
                                            <div class="mb-2">
                                                <strong data-en="Bus:" data-ta="‡Æ™‡Øá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ:">Bus:</strong>
                                                <div class="ms-3">
                                                    <small>{{ rec.details.bus.service }} - {{ rec.details.bus.from }} ‚Üí {{ rec.details.bus.to }}</small><br>
                                                    <small class="text-muted">{{ rec.details.bus.departure }} - {{ rec.details.bus.arrival }}</small>
                                                </div>
                                            </div>
                                            
                                            {% if rec.details.train %}
                                            <div class="mb-2">
                                                <strong data-en="Train:" data-ta="‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç:">Train:</strong>
                                                <div class="ms-3">
                                                    <small>{{ rec.details.train.number }} - {{ rec.details.train.from }} ‚Üí {{ rec.details.train.to }}</small><br>
                                                    <small class="text-muted">{{ rec.details.train.departure }} - {{ rec.details.train.arrival }}</small>
                                                </div>
                                            </div>
                                            {% endif %}
                                            
                                            {% if rec.details.flight %}
                                            <div class="mb-2">
                                                <strong data-en="Flight:" data-ta="‡Æµ‡Æø‡ÆÆ‡Ææ‡Æ©‡ÆÆ‡Øç:">Flight:</strong>
                                                <div class="ms-3">
                                                    <small>{{ rec.details.flight.number }} - {{ rec.details.flight.from }} ‚Üí {{ rec.details.flight.to }}</small><br>
                                                    <small class="text-muted">{{ rec.details.flight.departure }} - {{ rec.details.flight.arrival }}</small>
                                                </div>
                                            </div>
                                            {% endif %}
                                            
                                            <div class="alert alert-info mb-2 py-2">
                                                <small>
                                                    <i class="bi bi-clock"></i> <strong data-en="Connection Time:" data-ta="‡Æá‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ®‡Øá‡Æ∞‡ÆÆ‡Øç:">Connection Time:</strong> {{ rec.details.connection_time }}<br>
                                                    <i class="bi bi-people"></i> <strong data-en="Expected Crowd:" data-ta="‡Æé‡Æ§‡Æø‡Æ∞‡Øç‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æï‡ØÇ‡Æü‡Øç‡Æü‡ÆÆ‡Øç:">Expected Crowd:</strong> 
                                                    <span class="badge bg-{{ 'danger' if rec.details.crowd_level == 'high' else 'warning' if rec.details.crowd_level == 'moderate' else 'success' }}">
                                                        {{ rec.details.crowd_prediction }} passengers ({{ rec.details.crowd_level }})
                                                    </span>
                                                </small>
                                            </div>
                                            
                                            <p class="mb-0"><small class="text-success"><i class="bi bi-lightbulb"></i> {{ rec.recommendation }}</small></p>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            
                            {% if connecting_suggestions and connecting_suggestions|length %}
                            <div class="alert alert-warning" data-en="üí° Try connecting services via these hubs" data-ta="üí° ‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÆ‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡ØÇ‡Æ≤‡ÆÆ‡Øç ‡Æá‡Æ£‡Øà‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øà ‡ÆÆ‡ØÅ‡ÆØ‡Æ±‡Øç‡Æö‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç">
                                üí° Try connecting services via these hubs
                            </div>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>

                <!-- Train Options -->
                <div class="col-lg-6">
                    <div class="route-card">
                        <div class="route-header" style="border-color: #dc3545;">
                            <h5 class="mb-0">
                                <i class="bi bi-train-front text-danger"></i>
                                <span class="ms-2" data-en="Train Services" data-ta="‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç">Train Services</span>
                            </h5>
                        </div>
                        
                        <p class="text-muted small mb-3" data-en="Train options for your route" data-ta="‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æ¥‡Æø‡Æï‡Øç‡Æï‡Ææ‡Æ© ‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øç">
                            Train options for your route
                        </p>
                        
                        <div class="d-flex gap-2 mb-3">
                            <a target="_blank" href="{{ links.railyatri }}" class="btn btn-sm btn-primary">
                                <i class="bi bi-train-front"></i> RailYatri
                            </a>
                            <a target="_blank" href="{{ links.irctc }}" class="btn btn-sm btn-outline-danger">
                                IRCTC
                            </a>
                        </div>
                        
                        {% if origin_station_info %}
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i>
                            <strong data-en="Railway Station:" data-ta="‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡ÆÆ‡Øç:">Railway Station:</strong>
                            <span class="badge bg-primary">{{ origin_station_info.station }}</span>
                            {% if origin_station_info.distance != 'Direct' %}
                            <span class="small text-muted">({{ origin_station_info.distance }})</span>
                            {% endif %}
                        </div>
                        {% endif %}
                        
                        <div class="alert alert-light border">
                            <small class="text-muted">
                                <i class="bi bi-train-front"></i>
                                <span data-en="Train bookings will use nearest station: <strong>{{ origin_station_info.station if origin_station_info else q.origin }}</strong> to <strong>{{ dest_station_info.station if dest_station_info else q.destination }}</strong>" 
                                      data-ta="‡Æ∞‡ÆØ‡Æø‡Æ≤‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç ‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æ§‡Øç‡Æ§‡Øà‡Æ™‡Øç ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡ÆÆ‡Øç: <strong>{{ origin_station_info.station if origin_station_info else q.origin }}</strong> ‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡Øç <strong>{{ dest_station_info.station if dest_station_info else q.destination }}</strong>">
                                    Train bookings will use nearest station: <strong>{{ origin_station_info.station if origin_station_info else q.origin }}</strong> to <strong>{{ dest_station_info.station if dest_station_info else q.destination }}</strong>
                                </span>
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Flight Option Card -->
            <div class="col-lg-12 mt-3">
                <div class="route-card">
                    <div class="route-header" style="border-color: #0dcaf0;">
                        <h5 class="mb-0">
                            <i class="bi bi-airplane text-info"></i>
                            <span class="ms-2" data-en="Flight Options" data-ta="‡Æµ‡Æø‡ÆÆ‡Ææ‡Æ© ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øç">Flight Options</span>
                        </h5>
                    </div>
                    
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <p class="text-muted small mb-2" data-en="For faster travel from <strong>{{ q.origin }}</strong> to <strong>{{ q.destination }}</strong>" data-ta="<strong>{{ q.origin }}</strong> ‡Æá‡Æ≤‡Æø‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ <strong>{{ q.destination }}</strong> ‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æ© ‡Æ™‡ÆØ‡Æ£‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ">
                                For faster travel from <strong>{{ q.origin }}</strong> to <strong>{{ q.destination }}</strong>
                            </p>
                            <div class="small">
                                <i class="bi bi-airplane-fill text-info"></i>
                                <span data-en="Nearest Airports:" data-ta="‡ÆÖ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ≤‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æµ‡Æø‡ÆÆ‡Ææ‡Æ© ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç:">Nearest Airports:</span>
                                <span class="badge bg-info">{{ origin_airport }}</span> 
                                <span data-en="to" data-ta="‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡Øç">to</span> 
                                <span class="badge bg-info">{{ dest_airport }}</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <a target="_blank" href="{{ links.flights }}" class="btn btn-sm btn-info">
                                <i class="bi bi-airplane-fill"></i> <span data-en="Check Flights" data-ta="‡Æµ‡Æø‡ÆÆ‡Ææ‡Æ©‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï">Check Flights</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <!-- No Route Selected State -->
            <div class="text-center py-5">
                <i class="bi bi-compass" style="font-size: 4rem; color: #667eea;"></i>
                <h4 class="mt-3 mb-3" data-en="Select Your Route to Get Started" data-ta="‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æ¥‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç">Select Your Route to Get Started</h4>
                <p class="text-muted mb-4" data-en="Choose your origin and destination above to see available travel options" data-ta="‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æ™‡ÆØ‡Æ£ ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï ‡ÆÆ‡Øá‡Æ≤‡Øá ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Øä‡Æü‡Æï‡Øç‡Æï‡Æ™‡Øç ‡Æ™‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æø ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Æï‡Øç‡Æï‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç">
                    Choose your origin and destination above to see available travel options
                </p>
                <div class="alert alert-info d-inline-block">
                    <i class="bi bi-lightbulb"></i>
                    <span data-en="üí° Tip: Select both 'From' and 'To' locations and click Search to get personalized travel plans" data-ta="üí° ‡Æï‡ØÅ‡Æ±‡Æø‡Æ™‡Øç‡Æ™‡ØÅ: '‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ' ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç '‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ' ‡Æá‡Æ∞‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ ‡Æ§‡Øá‡Æü‡Æ≤‡Øà‡Æï‡Øç ‡Æï‡Æø‡Æ≥‡Æø‡Æï‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Æ©‡Æø‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡ÆØ‡Æ£‡Æ§‡Øç ‡Æ§‡Æø‡Æü‡Øç‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±">
                        üí° Tip: Select both 'From' and 'To' locations and click Search to get personalized travel plans
                    </span>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<footer class="border-top py-3 mt-5" style="position: relative; z-index: 10;">
    <div class="container text-center text-muted small">
        Designed and developed by the Nextlinker under CSP Project | KARE
    </div>
</footer>

<script>
let currentLang = localStorage.getItem('preferredLang') || 'en';

function changeLang(lang) {
    currentLang = lang === 'en' ? 'en' : 'ta';
    const elements = document.querySelectorAll('[data-en][data-ta]');
    elements.forEach(el => {
        el.innerHTML = el.getAttribute('data-' + currentLang);
    });
    document.getElementById('langText').textContent = currentLang === 'en' ? '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç' : 'English';
    localStorage.setItem('preferredLang', currentLang);
}

// Apply language on load
document.addEventListener('DOMContentLoaded', () => {
    changeLang(currentLang);
});

// Auto-fill destination from localStorage if available
const selectedDest = localStorage.getItem('selectedDestination');
if (selectedDest && !document.getElementById('destinationSelect').value) {
    document.getElementById('destinationSelect').value = selectedDest;
}

// Set minimum date to today
const today = new Date().toISOString().split('T')[0];
const dateInput = document.getElementById('travelDate');
if (dateInput && !dateInput.value) {
    dateInput.setAttribute('min', today);
}

// Form validation - ensure both origin and destination are selected
document.getElementById('routeForm').addEventListener('submit', function(e) {
    const origin = document.getElementById('originSelect').value;
    const destination = document.getElementById('destinationSelect').value;
    
    if (!origin || !destination) {
        e.preventDefault();
        alert('Please select both origin and destination to search for travel options.');
        return false;
    }
    
    if (origin === destination) {
        e.preventDefault();
        alert('Origin and destination cannot be the same. Please select different locations.');
        return false;
    }
});
</script>
</body>
</html>
